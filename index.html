<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAZ Calculator</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800;900&display=swap');
        :root {
            --primary-orange: #ff6600; 
            --glow-purple: rgba(138, 43, 226, 0.7);
            --glass-bg: rgba(20, 20, 28, 0.90);
            --text-white: #ffffff;
            --money-green: #00ff9d;
            --bg-color: #2b2e36; 
        }
        body {
            margin: 0; padding: 0;
            font-family: 'Montserrat', sans-serif;
            min-height: 100vh;
            background-color: var(--bg-color);
            color: var(--text-white);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        /* ПК ВЕРСИЯ */
        @media (min-width: 769px) {
            body {
                /* ССЫЛКА НА ВАШ ФАЙЛ FOTO.JPG */
                background-image: url('foto.jpg'); 
                background-size: cover;
                background-position: center;
                background-attachment: fixed;
                padding: 40px 0;
            }
            body::before {
                content: ''; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
                background: rgba(0, 0, 0, 0.5); z-index: -1; backdrop-filter: blur(4px);
            }
            .mobile-header-image { display: none; }
        }
        /* МОБИЛЬНАЯ ВЕРСИЯ */
        @media (max-width: 768px) {
            .mobile-header-image {
                display: block; width: 100%; height: auto; position: relative; z-index: 1;
            }
            .mobile-header-image img {
                width: 100%; height: auto; display: block;
                mask-image: linear-gradient(to bottom, black 80%, transparent 100%);
                -webkit-mask-image: linear-gradient(to bottom, black 80%, transparent 100%);
            }
            .main-container { margin-top: -30px; position: relative; z-index: 2; padding: 0 15px; }
        }
        .main-container { width: 100%; max-width: 480px; display: flex; flex-direction: column; gap: 20px; margin-bottom: 50px; }
        .calculator-card, .history-card {
            background: var(--glass-bg); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            padding: 25px; border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5), inset 0 0 1px rgba(255,255,255,0.2);
            border: 1px solid rgba(255, 255, 255, 0.1); position: relative; overflow: hidden;
        }
        .calculator-card::after {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px;
            background: linear-gradient(90deg, var(--glow-purple), var(--primary-orange));
        }
        h1 { text-align: center; text-transform: uppercase; font-weight: 900; margin: 0 0 20px 0; letter-spacing: 1px; font-size: 1.6em; }
        h1 span { color: var(--primary-orange); }
        .mode-toggle { display: flex; background: rgba(0,0,0,0.4); border-radius: 12px; padding: 4px; margin-bottom: 20px; border: 1px solid rgba(255,255,255,0.05); }
        .mode-btn { flex: 1; background: transparent; border: none; color: #888; padding: 10px; font-family: 'Montserrat', sans-serif; font-weight: 700; font-size: 0.8em; cursor: pointer; border-radius: 8px; transition: 0.3s; text-transform: uppercase; }
        .mode-btn.active { background: var(--primary-orange); color: white; box-shadow: 0 4px 15px rgba(255, 102, 0, 0.4); }
        .input-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.75em; margin-bottom: 6px; color: #ccc; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; }
        input { width: 100%; padding: 14px; box-sizing: border-box; background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 10px; color: white; font-size: 1.2em; font-family: 'Montserrat', sans-serif; font-weight: 600; }
        input:focus { outline: none; border-color: var(--primary-orange); background: rgba(0, 0, 0, 0.6); }
        .hidden { display: none; }
        .row-2-col { display: flex; gap: 15px; } .row-2-col .input-group { flex: 1; }
        .btn-calc { width: 100%; padding: 18px; background: linear-gradient(135deg, #ff6600, #ff4500); color: white; border: none; border-radius: 12px; font-size: 1.1em; font-weight: 900; text-transform: uppercase; cursor: pointer; transition: 0.3s; margin-top: 10px; box-shadow: 0 10px 20px rgba(255, 69, 0, 0.3); }
        .results { margin-top: 25px; background: rgba(0,0,0,0.3); border-radius: 15px; padding: 15px; border: 1px solid rgba(255,255,255,0.05); display: none; }
        .result-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .result-item:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
        .result-label { font-size: 0.85em; color: #ccc; } .result-value { font-size: 1.2em; font-weight: 800; color: var(--primary-orange); } .money-val { color: var(--money-green); }
        .global-stats-container { margin-top: 20px; padding: 15px; background: linear-gradient(135deg, rgba(138, 43, 226, 0.15), rgba(0,0,0,0.3)); border-radius: 15px; text-align: center; border: 1px solid rgba(138, 43, 226, 0.3); display: none; }
        .global-stats-container span { display: block; font-size: 0.75em; color: #bbb; margin-bottom: 5px; letter-spacing: 2px; } .global-stats-container strong { font-size: 1.8em; color: #fff; display: block; margin-bottom: 8px;}
        .global-sub-stat { font-size: 0.85em; color: var(--money-green); font-weight: 600; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.1); }
        .error-msg { color: #ff4d4d; background: rgba(255, 77, 77, 0.1); padding: 10px; border-radius: 8px; text-align: center; margin-top: 15px; display: none; }
        .history-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); } .history-header h3 { margin: 0; font-size: 1em; text-transform: uppercase; color: #fff; }
        .btn-clear { background: transparent; border: 1px solid rgba(255, 77, 77, 0.5); color: #ff4d4d; padding: 6px 14px; border-radius: 6px; cursor: pointer; font-weight: 700; font-size: 0.75em; }
        .table-container { max-height: 250px; overflow-y: auto; border-radius: 10px; background: rgba(0,0,0,0.2); } .table-container::-webkit-scrollbar { width: 4px; } .table-container::-webkit-scrollbar-thumb { background: var(--primary-orange); border-radius: 2px; }
        table { width: 100%; border-collapse: collapse; font-size: 0.8em; } th { text-align: left; padding: 10px 8px; background: rgba(0,0,0,0.6); position: sticky; top: 0; color: var(--primary-orange); } td { text-align: left; padding: 10px 8px; border-bottom: 1px solid rgba(255, 255, 255, 0.05); color: #ddd; } .td-money { color: var(--money-green); font-weight: bold; }
    </style>
</head>
<body>
    <div class="mobile-header-image">
        <!-- КАРТИНКА ДЛЯ ТЕЛЕФОНА -->
        <img src="foto.jpg" alt="GAZ Header">
    </div>
    <div class="main-container">
        <div class="calculator-card">
            <h1>Расход <span>топлива</span></h1>
            <div class="mode-toggle">
                <button class="mode-btn active" id="btn-mode-odo" onclick="setMode('odo')">Одометр</button>
                <button class="mode-btn" id="btn-mode-dist" onclick="setMode('dist')">Пробег (Trip)</button>
            </div>
            <div id="mode-odo-container">
                <div class="row-2-col">
                    <div class="input-group"><label for="odo-prev">Старт (км)</label><input type="number" id="odo-prev" placeholder="10000"></div>
                    <div class="input-group"><label for="odo-curr">Финиш (км)</label><input type="number" id="odo-curr" placeholder="10450"></div>
                </div>
            </div>
            <div id="mode-dist-container" class="hidden">
                <div class="input-group"><label for="dist-direct">Проехано (км)</label><input type="number" id="dist-direct" placeholder="450"></div>
            </div>
            <div class="row-2-col">
                <div class="input-group"><label for="fuel-liters">Литры</label><input type="number" id="fuel-liters" placeholder="60"></div>
                <div class="input-group"><label for="price-liter">Цена за 1л</label><input type="number" id="price-liter" placeholder="55.50"></div>
            </div>
            <button class="btn-calc" onclick="calculateFuel()">РАССЧИТАТЬ</button>
            <div id="error-box" class="error-msg"></div>
            <div class="results" id="results-box">
                <div class="result-item"><span class="result-label">Пройдено:</span><span class="result-value" id="res-distance">0 км</span></div>
                <div class="result-item"><span class="result-label">Расход / 100км:</span><span class="result-value" id="res-consumption">0 л</span></div>
                <div class="result-item"><span class="result-label">Стоимость поездки:</span><span class="result-value money-val" id="res-total-cost">0 ₽</span></div>
                <div class="result-item" style="border-top: 1px solid rgba(255,255,255,0.1); margin-top:5px; padding-top:10px;">
                    <span class="result-label" style="color: #fff; font-weight:bold;">Цена 1 км пути:</span><span class="result-value money-val" id="res-km-cost" style="font-size: 1.4em;">0 ₽</span>
                </div>
            </div>
            <div class="global-stats-container" id="global-stats-box">
                <span>СРЕДНИЙ ЗА ВСЕ ВРЕМЯ</span><strong id="global-avg">0.00 л/100км</strong>
                <div id="global-cost-avg" class="global-sub-stat">Средняя цена 1 км: 0.00 ₽</div>
            </div>
        </div>
        <div class="history-card">
            <div class="history-header"><h3>История (200 зап.)</h3><button class="btn-clear" onclick="clearHistory()">СБРОС</button></div>
            <div class="table-container">
                <table><thead><tr><th>Дата</th><th>КМ</th><th>Л</th><th>Руб</th><th>Расх.</th></tr></thead><tbody id="history-body"></tbody></table>
            </div>
        </div>
    </div>
    <script>
        let calculationMode='odo';let historyData=JSON.parse(localStorage.getItem('gazFuelHistory'))||[];let lastPrice=localStorage.getItem('lastFuelPrice');
        window.onload=function(){renderHistoryTable();if(historyData.length>0){updateGlobalStats()}if(historyData.length>0&&historyData[0].currOdo){document.getElementById('odo-prev').value=historyData[0].currOdo}if(lastPrice){document.getElementById('price-liter').value=lastPrice}};
        function setMode(e){calculationMode=e;const t=document.getElementById("btn-mode-odo"),l=document.getElementById("btn-mode-dist"),n=document.getElementById("mode-odo-container"),d=document.getElementById("mode-dist-container");document.getElementById("error-box").style.display="none","odo"===e?(t.classList.add("active"),l.classList.remove("active"),n.classList.remove("hidden"),d.classList.add("hidden")):(l.classList.add("active"),t.classList.remove("active"),d.classList.remove("hidden"),n.classList.add("hidden"))}
        function calculateFuel(){const e=parseFloat(document.getElementById("fuel-liters").value),t=parseFloat(document.getElementById("price-liter").value);document.getElementById("error-box").style.display="none";let l=0,n=null;if("odo"===calculationMode){const e=parseFloat(document.getElementById("odo-prev").value),t=parseFloat(document.getElementById("odo-curr").value);if(isNaN(e)||isNaN(t))return void showError("Укажите одометр");if(t<=e)return void showError("Финиш > Старта");l=t-e,n=t}else{const e=parseFloat(document.getElementById("dist-direct").value);if(isNaN(e)||e<=0)return void showError("Введите пробег");l=e}if(isNaN(e)||e<=0)return void showError("Введите литры");if(isNaN(t)||t<=0)return void showError("Введите цену");const d=e/l*100,a=e*t,o=a/l;document.getElementById("res-distance").innerText=l.toFixed(1)+" км",document.getElementById("res-consumption").innerText=d.toFixed(2)+" л/100",document.getElementById("res-total-cost").innerText=Math.round(a)+" ₽",document.getElementById("res-km-cost").innerText=o.toFixed(2)+" ₽",document.getElementById("results-box").style.display="block",localStorage.setItem("lastFuelPrice",t);const r={id:Date.now(),date:new Date().toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"}),dist:l,lit:e,price:t,totalCost:a,cons:d,currOdo:n};historyData.unshift(r),historyData.length>200&&historyData.pop(),saveAndRender()}
        function renderHistoryTable(){const e=document.getElementById("history-body");if(e.innerHTML="",0===historyData.length)return e.innerHTML='<tr><td colspan="5" style="text-align:center; color:#666; padding: 20px;">Нет данных</td></tr>',void(document.getElementById("global-stats-box").style.display="none");historyData.forEach(t=>{const l=t.totalCost?Math.round(t.totalCost):"-",n=`<tr><td>${t.date}</td><td>${t.dist.toFixed(0)}</td><td>${t.lit.toFixed(1)}</td><td class="td-money">${l}</td><td style="color:#fff; font-weight:bold;">${t.cons.toFixed(1)}</td></tr>`;e.insertAdjacentHTML("beforeend",n)}),updateGlobalStats()}
        function updateGlobalStats(){if(0===historyData.length)return;document.getElementById("global-stats-box").style.display="block";let e=0,t=0,l=0;historyData.forEach(n=>{e+=n.dist,t+=n.lit,n.totalCost?l+=n.totalCost:n.price&&n.lit&&(l+=n.price*n.lit)});if(e>0){const n=t/e*100;document.getElementById("global-avg").innerText=n.toFixed(2)+" л/100км";const d=l/e;document.getElementById("global-cost-avg").innerText="Средняя цена 1 км: "+d.toFixed(2)+" ₽"}}
        function saveAndRender(){localStorage.setItem("gazFuelHistory",JSON.stringify(historyData)),renderHistoryTable()}
        function clearHistory(){confirm("Удалить всю историю?")&&(historyData=[],saveAndRender(),document.getElementById("results-box").style.display="none",document.getElementById("global-stats-box").style.display="none",document.getElementById("odo-prev").value="",document.getElementById("odo-curr").value="",document.getElementById("dist-direct").value="",document.getElementById("fuel-liters").value="")}
        function showError(e){const t=document.getElementById("error-box");t.innerText=e,t.style.display="block"}
    </script>
</body>
</html>
